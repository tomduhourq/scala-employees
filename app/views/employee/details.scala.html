@(id: Option[Int], employee: Form[Details], companies: Seq[Company], positions: Seq[Position])(implicit flash: Flash)

@import views.ViewHelpers._

@extractCompanyName = @{
  companies.filter(_.name == employee.get.company)(0).name
}

@extractPositionName = @{
  positions.filter(_.name == employee.get.position)(0).name
}

@main {
  @if(employee.hasErrors) {
    <div class="alert alert-error">
      <button type="button" class="close" data-dismiss="alert">&times;</button>
        Please fix the validation errors.
    </div>
  }

  @helper.form(action = if (id.isDefined) routes.Application.update(id.get) else routes.Application.insert) {
    @helper.inputText(employee("name"), '_label -> "Name")
    @helper.select(field = employee("company"),
                   options = tuplify(companies),
                   '_label -> "Company",
                   '_default -> extractCompanyName)
    @helper.select(field = employee("position"),
                   options = tuplify(positions),
                   '_label -> "Position",
                   '_default -> extractPositionName)
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">
        @if(id.isDefined) { Save Employee } else { Add Employee }
      </button>
      <a href="@routes.Application.index" class="btn">Cancel</a>
    </div>
  }
}